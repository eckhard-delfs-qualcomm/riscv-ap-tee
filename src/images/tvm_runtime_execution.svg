<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="2337" height="2653"><desc>title%20TVM%20runtime%20execution%0Aparticipant%20TVM%0Aalt%0Anote%20over%20TSM%2CTVM%3A%20TVM%20faults%20that%20can't%20be%20handled%20by%20the%20TSM%20will%20result%20in%20an%20exit%20to%20the%20host%0ATVM-%3ETSM%3A%20Exit%20from%20TVM-execution%20loop%0ATSM-%3ETSM%3A%20Examine%20fault%20and%20update%20VCPU%20shared-memory%20state%0ATSM-%3EHost%3A%20Notify%20host%20about%20TVM%20exit%0Anote%20over%20Host%2CTSM%3A%20The%20host%20can%20resume%20TVM%20execution%20for%20resumable%20faults%0AHost-%3EHost%3A%20Examine%20exit%20code%20to%20see%20if%20fault%20is%20resumable%0AHost-%3ETSM%3A%20Resume%20TVM%20execution%0ATSM-%3ETSM%3A%20Update%20TVM%20state%0ATSM-%3ETVM%3A%20Resume%20TVM-execution%20loop%0Aend%0A%0Aalt%20TVM%20makes%20ECALL%20to%20setup%20shared-memory%2FMMIO%20region%0Anote%20over%20TSM%2CTVM%3A%20Guests%20can%20use%20ECALLs%20to%20relay%20information%20to%20the%20guest%20(example%3A%20setting%20up%20shared-memory%20and%20MMIO%20regions)%0ATVM-%3ETSM%3A%20Guest%20function%20ECALL%0ATSM-%3EHost%3A%20Notify%20host%20about%20guest-ECALL%20using%20per-VCPU%20shared%20address%20space%0AHost-%3EHost%3A%20Update%20shared%2FMMIO%20region%20information%0AHost-%3ETSM%3A%20Resume%20TVM%20execution%0Aend%0A%0Aalt%20TVM%20page-fault%20in%20confidential%20memory%20demand-zero%20region%0Anote%20over%20TSM%2CTVM%3A%20Guest%20page-fault%20in%20confidential%20memory%20region%0ATVM-%3ETSM%3A%20Exit%20from%20execution%20loop%0ATSM-%3EHost%3A%20Notify%20host%20about%20page-fault%20in%20confidential%20region%20using%20per-VCPU%20shared%20address%20space%0AHost-%3ETSM%3A%20Add%20confidential%20zero-pages%0ATSM-%3ETSM%3A%20Zero%20confidential%20page%20and%20add%20to%20TVM%20GPA%0AHost-%3ETSM%3A%20Resume%20TVM%20execution%0AHost-%3ETVM%3A%20Resume%20TVM-execution%20loop%0Aend%0A%0Aalt%20Resumable%20TVM%20fault%0Anote%20over%20TSM%2CTVM%3A%20Guest%20page-fault%20in%20non-confidential%20memory%20region%2C%20or%20virtual%20instruction%0ATVM-%3ETSM%3A%20Exit%20from%20execution%20loop%0ATSM-%3EHost%3A%20Notify%20host%20about%20page-fault%20in%20non-confidential%20region%20using%20per-VCPU%20shared%20address%20space%0AHost-%3EHost%3A%20Determine%20whether%20fault%20was%20caused%20by%20shared-memory%20access%20or%20MMIO%0Aalt%20Shared%20Memory%20page-fault%0Anote%20over%20TSM%2CHost%3A%20Shared-page%20faults%20are%20handled%20by%20napping%20non-confidential%20pages%20to%20the%20TVM%20GPA%0AHost-%3ETSM%3A%20Add%20non-confidential%20shared%20memory%20pages%0ATSM-%3ETSM%3A%20Add%20shared-memory%20pages%20to%20TVM%20GPA%0Aend%0Aalt%20TVM%20access%20to%20MMIO%0Anote%20over%20TSM%2CHost%3A%20MMIO%20faults%20are%20handled%20by%20updating%20the%20per-VCPU%20shared%20memory%20region%0AHost-%3EHost%3A%20Process%20MMIO%0Aend%0Aalt%20TVM%20virtual%20instruction%20exception%0Anote%20over%20TSM%2CHost%3A%20Virtual%20instruction%20faults%20are%20processed%20by%20decoding%20the%20information%20in%20per-VCPU%20shared%20state%0AHost-%3EHost%3A%20Process%20virtual%20instruction%0Aend%0AHost-%3ETSM%3A%20Resume%20TVM%20execution%0ATSM-%3ETSM%3A%20Update%20TVM%20state%0ATSM-%3ETVM%3A%20Resume%20TVM-execution%20loop%0Aend%0Aalt%20Non-resumable%20TVM%20fault%0Anote%20over%20TSM%2CTVM%3A%20Non-resumable%20faults%20render%20the%20VCPU%20into%20a%20non-runnable%20state.%20Attempts%20to%20restart%20execution%20on%20the%20VCPU%20will%20result%20in%20an%20error.%0ATVM-%3ETSM%3A%20Exit%20with%20non-resumable%20fault%0ATSM-%3ETSM%3A%20Mark%20VCPU%20as%20%22non%20runnable%22%0ATSM-%3EHost%3A%20Notify%20host%20about%20non-resumable%20fault%0Aend</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="2337" height="2653"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1041.13813700625" y="22.6179738" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TVM runtime execution</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 67.8539214 88.511670804 L 67.8539214 2653.3898997240008" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 88.511670804 L 1039.499220990625 2653.3898997240008" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1760.3978559992188 88.511670804 L 1760.3978559992188 2653.3898997240008" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 35.66580915545118 47.799317964000004 L 100.04203364454884 47.799317964000004 L 100.04203364454884 88.511670804 L 35.66580915545118 88.511670804 L 35.66580915545118 47.799317964000004 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="52.026143537451176" y="73.43302160400002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TVM</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1007.6722203870063 47.799317964000004 L 1071.3262215942436 47.799317964000004 L 1071.3262215942436 88.511670804 L 1007.6722203870063 88.511670804 L 1007.6722203870063 47.799317964000004 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1024.0325547690063" y="73.43302160400002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TSM</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1727.3319666550606 47.799317964000004 L 1793.463745343377 47.799317964000004 L 1793.463745343377 88.511670804 L 1727.3319666550606 88.511670804 L 1727.3319666550606 47.799317964000004 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1743.6923010370606" y="73.43302160400002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Host</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.283137120000006 159.381322044 L 1039.499220990625 159.381322044 L 1053.070005270625 172.952106324 L 1053.070005270625 194.062215204 L 54.283137120000006 194.062215204 L 54.283137120000006 159.381322044 M 1039.499220990625 159.381322044 L 1039.499220990625 172.952106324 L 1053.070005270625 172.952106324" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="274.165462796875" y="180.491430924" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TVM faults that can't be handled by the TSM will result in an exit to the host</text></g><g><g><rect fill="white" stroke="none" x="443.5592211419726" y="216.680189004" width="220.2347001066797" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.82101852197263" y="230.250973284" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Exit from TVM-execution loop</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 67.8539214 236.282432964 L 1027.084466482625 236.282432964" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,236.282432964) translate(-1039.499220990625,-236.282432964)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1026.933679990625 229.999662464 L 1039.499220990625 236.282432964 L 1026.933679990625 242.565203464 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1057.342289210625" y="258.90040676399997" width="402.30136575609373" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1059.604086590625" y="272.47119104399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Examine fault and update VCPU shared-memory state</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 278.502650724 L 1099.8138177906249 278.502650724 L 1099.8138177906249 298.104894684 L 1051.913975498625 298.104894684" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,298.104894684) translate(-1039.499220990625,-298.104894684)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1052.064761990625 291.82212418399996 L 1039.499220990625 298.104894684 L 1052.064761990625 304.387665184 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1300.1922953141407" y="320.722868484" width="199.5124863615625" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1302.4540926941406" y="334.29365276400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Notify host about TVM exit</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 340.325112444 L 1747.9831014912188 340.325112444" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1760.3978559992188,340.325112444) translate(-1760.3978559992188,-340.325112444)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1747.8323149992189 334.042341944 L 1760.3978559992188 340.325112444 L 1747.8323149992189 346.60788294400004 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1025.928436710625 362.943086244 L 1760.3978559992188 362.943086244 L 1773.9686402792188 376.513870524 L 1773.9686402792188 397.623979404 L 1025.928436710625 397.623979404 L 1025.928436710625 362.943086244 M 1760.3978559992188 362.943086244 L 1760.3978559992188 376.513870524 L 1773.9686402792188 376.513870524" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1190.309652996875" y="384.053195124" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">The host can resume TVM execution for resumable faults</text></g><g><g><rect fill="white" stroke="none" x="1778.2409242192189" y="420.24195320399997" width="340.1791428557031" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1780.5027215992188" y="433.81273748399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Examine exit code to see if fault is resumable</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1760.3978559992188 439.844197164 L 1820.7124527992187 439.844197164 L 1820.7124527992187 459.446441124 L 1772.8126105072188 459.446441124" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1760.3978559992188,459.446441124) translate(-1760.3978559992188,-459.446441124)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1772.9633969992187 453.16367062399996 L 1760.3978559992188 459.446441124 L 1772.9633969992187 465.729211624 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1312.036739589043" y="482.064414924" width="175.82359781175782" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1314.298536969043" y="495.63519920400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resume TVM execution</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1760.3978559992188 501.666658884 L 1051.913975498625 501.666658884" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,501.666658884) translate(-1039.499220990625,-501.666658884)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1052.064761990625 495.383888384 L 1039.499220990625 501.666658884 L 1052.064761990625 507.94942938400004 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1057.342289210625" y="524.284632684" width="135.80136575609376" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1059.604086590625" y="537.855416964" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Update TVM state</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 543.886876644 L 1099.8138177906249 543.886876644 L 1099.8138177906249 563.489120604 L 1051.913975498625 563.489120604" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,563.489120604) translate(-1039.499220990625,-563.489120604)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1052.064761990625 557.2063501040001 L 1039.499220990625 563.489120604 L 1052.064761990625 569.771891104 Z"/></g></g><g><g><rect fill="white" stroke="none" x="447.4481066400195" y="586.107094404" width="212.45692911058595" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="449.7099040200195" y="599.677878684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resume TVM-execution loop</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 605.709338364 L 80.268675908 605.709338364" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(67.8539214,605.709338364) translate(-67.8539214,-605.709338364)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 80.4194624 599.426567864 L 67.8539214 605.709338364 L 80.4194624 611.992108864 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.283137120000006 691.657638804 L 1039.499220990625 691.657638804 L 1053.070005270625 705.228423084 L 1053.070005270625 726.338531964 L 54.283137120000006 726.338531964 L 54.283137120000006 691.657638804 M 1039.499220990625 691.657638804 L 1039.499220990625 705.228423084 L 1053.070005270625 705.228423084" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="135.98211318749998" y="712.767747684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Guests can use ECALLs to relay information to the guest (example: setting up shared-memory and MMIO regions)</text></g><g><g><rect fill="white" stroke="none" x="472.28144251648433" y="748.956505764" width="162.79025735765626" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="474.54323989648435" y="762.527290044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Guest function ECALL</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 67.8539214 768.558749724 L 1027.084466482625 768.558749724" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,768.558749724) translate(-1039.499220990625,-768.558749724)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1026.933679990625 762.275979224 L 1039.499220990625 768.558749724 L 1026.933679990625 774.841520224 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1145.2200815690235" y="791.176723524" width="509.45691385179686" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1147.4818789490234" y="804.747507804" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Notify host about guest-ECALL using per-VCPU shared address space</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 810.778967484 L 1747.9831014912188 810.778967484" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1760.3978559992188,810.778967484) translate(-1760.3978559992188,-810.778967484)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1747.8323149992189 804.496196984 L 1760.3978559992188 810.778967484 L 1747.8323149992189 817.0617379839999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1778.2409242192189" y="833.3969412839999" width="298.83469095140623" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1780.5027215992188" y="846.9677255639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Update shared/MMIO region information</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1760.3978559992188 852.9991852439999 L 1820.7124527992187 852.9991852439999 L 1820.7124527992187 872.6014292039999 L 1772.8126105072188 872.6014292039999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1760.3978559992188,872.6014292039999) translate(-1760.3978559992188,-872.6014292039999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1772.9633969992187 866.318658704 L 1760.3978559992188 872.6014292039999 L 1772.9633969992187 878.8841997039999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1312.036739589043" y="895.2194030039999" width="175.82359781175782" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1314.298536969043" y="908.7901872839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resume TVM execution</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1760.3978559992188 914.8216469639999 L 1051.913975498625 914.8216469639999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,914.8216469639999) translate(-1039.499220990625,-914.8216469639999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1052.064761990625 908.5388764639999 L 1039.499220990625 914.8216469639999 L 1052.064761990625 921.1044174639999 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.283137120000006 1000.7699474039999 L 1039.499220990625 1000.7699474039999 L 1053.070005270625 1014.3407316839999 L 1053.070005270625 1035.450840564 L 54.283137120000006 1035.450840564 L 54.283137120000006 1000.7699474039999 M 1039.499220990625 1000.7699474039999 L 1039.499220990625 1014.3407316839999 L 1053.070005270625 1014.3407316839999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="379.26545364160154" y="1021.8800562839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Guest page-fault in confidential memory region</text></g><g><g><rect fill="white" stroke="none" x="462.03144251648433" y="1058.068814364" width="183.29025735765626" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="464.29323989648435" y="1071.639598644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Exit from execution loop</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 67.8539214 1077.671058324 L 1027.084466482625 1077.671058324" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,1077.671058324) translate(-1039.499220990625,-1077.671058324)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1026.933679990625 1071.388287824 L 1039.499220990625 1077.671058324 L 1026.933679990625 1083.9538288239999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1073.77563882" y="1100.289032124" width="652.3457993498438" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1076.0374362" y="1113.859816404" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Notify host about page-fault in confidential region using per-VCPU shared address space</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 1119.8912760839999 L 1747.9831014912188 1119.8912760839999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1760.3978559992188,1119.8912760839999) translate(-1760.3978559992188,-1119.8912760839999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1747.8323149992189 1113.6085055839999 L 1760.3978559992188 1119.8912760839999 L 1747.8323149992189 1126.1740465839998 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1295.136738063164" y="1142.509249884" width="209.62360086351563" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1297.398535443164" y="1156.080034164" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Add confidential zero-pages</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1760.3978559992188 1162.1114938439998 L 1051.913975498625 1162.1114938439998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,1162.1114938439998) translate(-1039.499220990625,-1162.1114938439998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1052.064761990625 1155.8287233439999 L 1039.499220990625 1162.1114938439998 L 1052.064761990625 1168.3942643439998 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1057.342289210625" y="1184.729467644" width="324.6236008635156" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1059.604086590625" y="1198.300251924" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Zero confidential page and add to TVM GPA</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 1204.331711604 L 1099.8138177906249 1204.331711604 L 1099.8138177906249 1223.933955564 L 1051.913975498625 1223.933955564" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,1223.933955564) translate(-1039.499220990625,-1223.933955564)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1052.064761990625 1217.651185064 L 1039.499220990625 1223.933955564 L 1052.064761990625 1230.2167260639999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1312.036739589043" y="1246.551929364" width="175.82359781175782" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1314.298536969043" y="1260.122713644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resume TVM execution</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1760.3978559992188 1266.1541733239999 L 1051.913975498625 1266.1541733239999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,1266.1541733239999) translate(-1039.499220990625,-1266.1541733239999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1052.064761990625 1259.871402824 L 1039.499220990625 1266.1541733239999 L 1052.064761990625 1272.4369438239999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="807.8974241443165" y="1288.772147124" width="212.45692911058595" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="810.1592215243164" y="1302.342931404" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resume TVM-execution loop</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1760.3978559992188 1308.3743910839999 L 80.268675908 1308.3743910839999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(67.8539214,1308.3743910839999) translate(-67.8539214,-1308.3743910839999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 80.4194624 1302.0916205839999 L 67.8539214 1308.3743910839999 L 80.4194624 1314.6571615839998 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.283137120000006 1394.3226915239998 L 1039.499220990625 1394.3226915239998 L 1053.070005270625 1407.8934758039998 L 1053.070005270625 1429.0035846839999 L 54.283137120000006 1429.0035846839999 L 54.283137120000006 1394.3226915239998 M 1039.499220990625 1394.3226915239998 L 1039.499220990625 1407.8934758039998 L 1053.070005270625 1407.8934758039998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="283.393246" y="1415.4328004039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Guest page-fault in non-confidential memory region, or virtual instruction</text></g><g><g><rect fill="white" stroke="none" x="462.03144251648433" y="1451.621558484" width="183.29025735765626" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="464.29323989648435" y="1465.192342764" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Exit from execution loop</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 67.8539214 1471.2238024439998 L 1027.084466482625 1471.2238024439998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,1471.2238024439998) translate(-1039.499220990625,-1471.2238024439998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1026.933679990625 1464.9410319439999 L 1039.499220990625 1471.2238024439998 L 1026.933679990625 1477.5065729439998 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1057.342289210625" y="1493.841776244" width="685.2124985685938" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1059.604086590625" y="1507.412560524" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Notify host about page-fault in non-confidential region using per-VCPU shared address space</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 1513.4440202039998 L 1747.9831014912188 1513.4440202039998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1760.3978559992188,1513.4440202039998) translate(-1760.3978559992188,-1513.4440202039998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1747.8323149992189 1507.1612497039998 L 1760.3978559992188 1513.4440202039998 L 1747.8323149992189 1519.7267907039998 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1778.2409242192189" y="1536.0619940039999" width="538.9458359709375" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1780.5027215992188" y="1549.6327782839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Determine whether fault was caused by shared-memory access or MMIO</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1760.3978559992188 1555.664237964 L 1820.7124527992187 1555.664237964 L 1820.7124527992187 1575.266481924 L 1772.8126105072188 1575.266481924" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1760.3978559992188,1575.266481924) translate(-1760.3978559992188,-1575.266481924)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1772.9633969992187 1568.983711424 L 1760.3978559992188 1575.266481924 L 1772.9633969992187 1581.5492524239999 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1025.928436710625 1638.5968085639997 L 1760.3978559992188 1638.5968085639997 L 1773.9686402792188 1652.1675928439997 L 1773.9686402792188 1673.2777017239998 L 1025.928436710625 1673.2777017239998 L 1025.928436710625 1638.5968085639997 M 1760.3978559992188 1638.5968085639997 L 1760.3978559992188 1652.1675928439997 L 1773.9686402792188 1652.1675928439997" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1095.1985384949219" y="1659.7069174439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Shared-page faults are handled by napping non-confidential pages to the TVM GPA</text></g><g><g><rect fill="white" stroke="none" x="1236.886738063164" y="1695.895675524" width="326.1236008635156" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1239.148535443164" y="1709.466459804" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Add non-confidential shared memory pages</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1760.3978559992188 1715.4979194839998 L 1051.913975498625 1715.4979194839998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,1715.4979194839998) translate(-1039.499220990625,-1715.4979194839998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1052.064761990625 1709.2151489839998 L 1039.499220990625 1715.4979194839998 L 1052.064761990625 1721.7806899839998 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1057.342289210625" y="1738.1158932839999" width="292.79025735765623" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1059.604086590625" y="1751.6866775639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Add shared-memory pages to TVM GPA</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 1757.718137244 L 1099.8138177906249 1757.718137244 L 1099.8138177906249 1777.320381204 L 1051.913975498625 1777.320381204" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,1777.320381204) translate(-1039.499220990625,-1777.320381204)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1052.064761990625 1771.037610704 L 1039.499220990625 1777.320381204 L 1052.064761990625 1783.6031517039999 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1025.928436710625 1863.2686816439998 L 1760.3978559992188 1863.2686816439998 L 1773.9686402792188 1876.8394659239998 L 1773.9686402792188 1897.949574804 L 1025.928436710625 1897.949574804 L 1025.928436710625 1863.2686816439998 M 1760.3978559992188 1863.2686816439998 L 1760.3978559992188 1876.8394659239998 L 1773.9686402792188 1876.8394659239998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1127.6429965027344" y="1884.378790524" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MMIO faults are handled by updating the per-VCPU shared memory region</text></g><g><g><rect fill="white" stroke="none" x="1778.2409242192189" y="1920.567548604" width="106.02359476" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1780.5027215992188" y="1934.138332884" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Process MMIO</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1760.3978559992188 1940.169792564 L 1820.7124527992187 1940.169792564 L 1820.7124527992187 1959.772036524 L 1772.8126105072188 1959.772036524" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1760.3978559992188,1959.772036524) translate(-1760.3978559992188,-1959.772036524)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1772.9633969992187 1953.489266024 L 1760.3978559992188 1959.772036524 L 1772.9633969992187 1966.054807024 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1025.928436710625 2045.720336964 L 1760.3978559992188 2045.720336964 L 1773.9686402792188 2059.291121244 L 1773.9686402792188 2080.401230124 L 1025.928436710625 2080.401230124 L 1025.928436710625 2045.720336964 M 1760.3978559992188 2045.720336964 L 1760.3978559992188 2059.291121244 L 1773.9686402792188 2059.291121244" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1057.9652010925781" y="2066.830445844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Virtual instruction faults are processed by decoding the information in per-VCPU shared state</text></g><g><g><rect fill="white" stroke="none" x="1778.2409242192189" y="2103.019203924" width="194.7124833098047" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1780.5027215992188" y="2116.5899882040003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Process virtual instruction</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1760.3978559992188 2122.6214478839997 L 1820.7124527992187 2122.6214478839997 L 1820.7124527992187 2142.223691844 L 1772.8126105072188 2142.223691844" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1760.3978559992188,2142.223691844) translate(-1760.3978559992188,-2142.223691844)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1772.9633969992187 2135.940921344 L 1760.3978559992188 2142.223691844 L 1772.9633969992187 2148.506462344 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1312.036739589043" y="2187.459639444" width="175.82359781175782" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1314.298536969043" y="2201.0304237240002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resume TVM execution</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1760.3978559992188 2207.061883404 L 1051.913975498625 2207.061883404" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,2207.061883404) translate(-1039.499220990625,-2207.061883404)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1052.064761990625 2200.779112904 L 1039.499220990625 2207.061883404 L 1052.064761990625 2213.344653904 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1057.342289210625" y="2229.679857204" width="135.80136575609376" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1059.604086590625" y="2243.2506414840004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Update TVM state</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 2249.282101164 L 1099.8138177906249 2249.282101164 L 1099.8138177906249 2268.884345124 L 1051.913975498625 2268.884345124" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,2268.884345124) translate(-1039.499220990625,-2268.884345124)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1052.064761990625 2262.601574624 L 1039.499220990625 2268.884345124 L 1052.064761990625 2275.167115624 Z"/></g></g><g><g><rect fill="white" stroke="none" x="447.4481066400195" y="2291.502318924" width="212.45692911058595" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="449.7099040200195" y="2305.0731032040003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resume TVM-execution loop</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 2311.104562884 L 80.268675908 2311.104562884" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(67.8539214,2311.104562884) translate(-67.8539214,-2311.104562884)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 80.4194624 2304.821792384 L 67.8539214 2311.104562884 L 80.4194624 2317.387333384 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.283137120000006 2397.0528633240006 L 1039.499220990625 2397.0528633240006 L 1053.070005270625 2410.623647604001 L 1053.070005270625 2431.7337564840004 L 54.283137120000006 2431.7337564840004 L 54.283137120000006 2397.0528633240006 M 1039.499220990625 2397.0528633240006 L 1039.499220990625 2410.623647604001 L 1053.070005270625 2410.623647604001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="75.39324599999998" y="2418.1629722040007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Non-resumable faults render the VCPU into a non-runnable state. Attempts to restart execution on the VCPU will result in an error.</text></g><g><g><rect fill="white" stroke="none" x="443.1981066400195" y="2454.3517302840005" width="220.95692911058595" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.4599040200195" y="2467.9225145640007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Exit with non-resumable fault</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 67.8539214 2473.9539742440006 L 1027.084466482625 2473.9539742440006" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,2473.9539742440006) translate(-1039.499220990625,-2473.9539742440006)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1026.933679990625 2467.6712037440006 L 1039.499220990625 2473.9539742440006 L 1026.933679990625 2480.2367447440006 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1057.342289210625" y="2496.5719480440007" width="222.25693216234376" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1059.604086590625" y="2510.142732324001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Mark VCPU as "non runnable"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 2516.1741920040004 L 1099.8138177906249 2516.1741920040004 L 1099.8138177906249 2535.7764359640005 L 1051.913975498625 2535.7764359640005" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1039.499220990625,2535.7764359640005) translate(-1039.499220990625,-2535.7764359640005)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1052.064761990625 2529.4936654640005 L 1039.499220990625 2535.7764359640005 L 1052.064761990625 2542.0592064640005 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1257.8978464616016" y="2558.3944097640006" width="284.1013840666406" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1260.1596438416016" y="2571.965194044001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Notify host about non-resumable fault</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1039.499220990625 2577.9966537240007 L 1747.9831014912188 2577.9966537240007" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1760.3978559992188,2577.9966537240007) translate(-1760.3978559992188,-2577.9966537240007)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1747.8323149992189 2571.7138832240007 L 1760.3978559992188 2577.9966537240007 L 1747.8323149992189 2584.2794242240006 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 118.668969204 L 2123.697594294922 118.668969204 L 2123.697594294922 628.327312164 L 15.078649200000001 628.327312164 L 15.078649200000001 118.668969204 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 118.668969204 L 15.078649200000001 136.763348244 L 62.79150294362793 136.763348244 L 71.83869246362794 127.71615872400001 L 71.83869246362794 118.668969204 L 15.078649200000001 118.668969204" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="30.157298400000002" y="130.731888564" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 650.9452859639999 L 2082.353142390625 650.9452859639999 L 2082.353142390625 937.4396207639999 L 15.078649200000001 937.4396207639999 L 15.078649200000001 650.9452859639999 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 650.9452859639999 L 15.078649200000001 669.039665004 L 62.79150294362793 669.039665004 L 71.83869246362794 659.9924754839999 L 71.83869246362794 650.9452859639999 L 15.078649200000001 650.9452859639999" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="30.157298400000002" y="663.008205324" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="84.65554428362793" y="652.1515779" width="391.52359476" height="15.681795168000004"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="86.91734166362794" y="663.008205324" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[TVM makes ECALL to setup shared-memory/MMIO region]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 960.0575945639998 L 1813.1731281992188 960.0575945639998 L 1813.1731281992188 1330.992364884 L 15.078649200000001 1330.992364884 L 15.078649200000001 960.0575945639998 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 960.0575945639998 L 15.078649200000001 978.1519736039999 L 62.79150294362793 978.1519736039999 L 71.83869246362794 969.1047840839998 L 71.83869246362794 960.0575945639998 L 15.078649200000001 960.0575945639998" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="30.157298400000002" y="972.1205139239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="84.65554428362793" y="961.2638864999999" width="411.1013840666406" height="15.681795168000004"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="86.91734166362794" y="972.1205139239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[TVM page-fault in confidential memory demand-zero region]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 1353.610338684 L 2322.4642874101564 1353.610338684 L 2322.4642874101564 2333.7225366840003 L 15.078649200000001 2333.7225366840003 L 15.078649200000001 1353.610338684 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 1353.610338684 L 15.078649200000001 1371.704717724 L 62.79150294362793 1371.704717724 L 71.83869246362794 1362.657528204 L 71.83869246362794 1353.610338684 L 15.078649200000001 1353.610338684" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="30.157298400000002" y="1365.673258044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="84.65554428362793" y="1354.81663062" width="156.05693521410157" height="15.681795168000004"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="86.91734166362794" y="1365.673258044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Resumable TVM fault]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 986.723948790625 1597.884455724 L 1813.1731281992188 1597.884455724 L 1813.1731281992188 1799.938355004 L 986.723948790625 1799.938355004 L 986.723948790625 1597.884455724 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 986.723948790625 1597.884455724 L 986.723948790625 1615.9788347639999 L 1034.4368025342528 1615.9788347639999 L 1043.483992054253 1606.931645244 L 1043.483992054253 1597.884455724 L 986.723948790625 1597.884455724" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1001.8025979906249" y="1609.947375084" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="1056.300843874253" y="1599.09074766" width="192.2235917082422" height="15.681795168000004"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1058.5626412542529" y="1609.947375084" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Shared Memory page-fault]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 986.723948790625 1822.556328804 L 1889.5420461992187 1822.556328804 L 1889.5420461992187 1982.390010324 L 986.723948790625 1982.390010324 L 986.723948790625 1822.556328804 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 986.723948790625 1822.556328804 L 986.723948790625 1840.650707844 L 1034.4368025342528 1840.650707844 L 1043.483992054253 1831.603518324 L 1043.483992054253 1822.556328804 L 986.723948790625 1822.556328804" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1001.8025979906249" y="1834.619248164" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="1056.300843874253" y="1823.76262074" width="151.42358865648438" height="15.681795168000004"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1058.5626412542529" y="1834.619248164" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[TVM access to MMIO]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 986.723948790625 2005.0079841240001 L 1978.2309347490234 2005.0079841240001 L 1978.2309347490234 2164.841665644 L 986.723948790625 2164.841665644 L 986.723948790625 2005.0079841240001 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 986.723948790625 2005.0079841240001 L 986.723948790625 2023.102363164 L 1034.4368025342528 2023.102363164 L 1043.483992054253 2014.0551736440002 L 1043.483992054253 2005.0079841240001 L 986.723948790625 2005.0079841240001" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1001.8025979906249" y="2017.0709034840002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="1056.300843874253" y="2006.2142760600002" width="236.66803445726563" height="15.681795168000004"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1058.5626412542529" y="2017.0709034840002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[TVM virtual instruction exception]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 2356.3405104840003 L 1813.1731281992188 2356.3405104840003 L 1813.1731281992188 2600.6146275240008 L 15.078649200000001 2600.6146275240008 L 15.078649200000001 2356.3405104840003 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 2356.3405104840003 L 15.078649200000001 2374.4348895240005 L 62.79150294362793 2374.4348895240005 L 71.83869246362794 2365.387700004 L 71.83869246362794 2356.3405104840003 L 15.078649200000001 2356.3405104840003" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="30.157298400000002" y="2368.4034298440006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="84.65554428362793" y="2357.5468024200004" width="183.92358865648438" height="15.681795168000004"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="86.91734166362794" y="2368.4034298440006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Non-resumable TVM fault]</text></g></g><g/><g/><g/></g></svg>